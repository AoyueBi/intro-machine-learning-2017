# Solutions ch. 8 - Artificial neural networks {#solutions-ann}

Solutions to exercises of chapter \@ref(ann).

## Exercise 1


```r
library("neuralnet")
 
#To create a neural network to perform square root

#Generate 50 random numbers uniformly distributed between 0 and 100
#And store them as a dataframe
traininginput <-  as.data.frame(runif(50, min=0, max=100))
trainingoutput <- sqrt(traininginput)
 
#Column bind the data into one variable
trainingdata <- cbind(traininginput,trainingoutput)
colnames(trainingdata) <- c("Input","Output")
 
#Train the neural network
#Will have 10 hidden layers
#Threshold is a numeric value specifying the threshold for the partial
#derivatives of the error function as stopping criteria.
net.sqrt <- neuralnet(Output~Input,trainingdata, hidden=10, threshold=0.01)
print(net.sqrt)
```

```
## $call
## neuralnet(formula = Output ~ Input, data = trainingdata, hidden = 10, 
##     threshold = 0.01)
## 
## $response
##         Output
## 1  4.823607247
## 2  7.991182379
## 3  5.825693280
## 4  9.656289958
## 5  4.808863135
## 6  9.658756736
## 7  4.330238060
## 8  7.277315106
## 9  3.672898466
## 10 6.622732738
## 11 4.657694551
## 12 6.176951745
## 13 7.865939443
## 14 7.695303593
## 15 6.287164498
## 16 1.560329464
## 17 4.074531583
## 18 4.353643907
## 19 7.163585739
## 20 3.142426031
## 21 8.736721168
## 22 8.743245015
## 23 9.688457218
## 24 5.080378968
## 25 7.288697522
## 26 1.258788534
## 27 3.622919717
## 28 2.818854157
## 29 1.829666133
## 30 9.465912815
## 31 6.567489682
## 32 8.657224519
## 33 6.061026093
## 34 7.880613317
## 35 2.867588089
## 36 8.658985827
## 37 8.271332108
## 38 7.241218810
## 39 6.561643736
## 40 9.498075491
## 41 4.190758111
## 42 7.164106022
## 43 8.199799779
## 44 6.620807849
## 45 5.187892316
## 46 2.915649773
## 47 8.263629785
## 48 4.638955321
## 49 8.898890633
## 50 3.211832633
## 
## $covariate
##               [,1]
##  [1,] 23.267186875
##  [2,] 63.858995819
##  [3,] 33.938702196
##  [4,] 93.243935751
##  [5,] 23.125164653
##  [6,] 93.291581678
##  [7,] 18.750961660
##  [8,] 52.959315153
##  [9,] 13.490183139
## [10,] 43.860588921
## [11,] 21.694118530
## [12,] 38.154732855
## [13,] 61.873003328
## [14,] 59.217697382
## [15,] 39.528437424
## [16,]  2.434628038
## [17,] 16.601807624
## [18,] 18.954215269
## [19,] 51.316960645
## [20,]  9.874841361
## [21,] 76.330296765
## [22,] 76.444333396
## [23,] 93.866203260
## [24,] 25.810250454
## [25,] 53.125111572
## [26,]  1.584548573
## [27,] 13.125547278
## [28,]  7.945938758
## [29,]  3.347678157
## [30,] 89.603505423
## [31,] 43.131920719
## [32,] 74.947536364
## [33,] 36.736037303
## [34,] 62.104066252
## [35,]  8.223061450
## [36,] 74.978035549
## [37,] 68.414934841
## [38,] 52.435249859
## [39,] 43.055168516
## [40,] 90.213438030
## [41,] 17.562453542
## [42,] 51.324415090
## [43,] 67.236716417
## [44,] 43.835096573
## [45,] 26.914226683
## [46,]  8.501013601
## [47,] 68.287577224
## [48,] 21.519906470
## [49,] 79.190254491
## [50,] 10.315868864
## 
## $model.list
## $model.list$response
## [1] "Output"
## 
## $model.list$variables
## [1] "Input"
## 
## 
## $err.fct
## function (x, y) 
## {
##     1/2 * (y - x)^2
## }
## <environment: 0x7f901d8b6190>
## attr(,"type")
## [1] "sse"
## 
## $act.fct
## function (x) 
## {
##     1/(1 + exp(-x))
## }
## <environment: 0x7f901d8b6190>
## attr(,"type")
## [1] "logistic"
## 
## $linear.output
## [1] TRUE
## 
## $data
##           Input      Output
## 1  23.267186875 4.823607247
## 2  63.858995819 7.991182379
## 3  33.938702196 5.825693280
## 4  93.243935751 9.656289958
## 5  23.125164653 4.808863135
## 6  93.291581678 9.658756736
## 7  18.750961660 4.330238060
## 8  52.959315153 7.277315106
## 9  13.490183139 3.672898466
## 10 43.860588921 6.622732738
## 11 21.694118530 4.657694551
## 12 38.154732855 6.176951745
## 13 61.873003328 7.865939443
## 14 59.217697382 7.695303593
## 15 39.528437424 6.287164498
## 16  2.434628038 1.560329464
## 17 16.601807624 4.074531583
## 18 18.954215269 4.353643907
## 19 51.316960645 7.163585739
## 20  9.874841361 3.142426031
## 21 76.330296765 8.736721168
## 22 76.444333396 8.743245015
## 23 93.866203260 9.688457218
## 24 25.810250454 5.080378968
## 25 53.125111572 7.288697522
## 26  1.584548573 1.258788534
## 27 13.125547278 3.622919717
## 28  7.945938758 2.818854157
## 29  3.347678157 1.829666133
## 30 89.603505423 9.465912815
## 31 43.131920719 6.567489682
## 32 74.947536364 8.657224519
## 33 36.736037303 6.061026093
## 34 62.104066252 7.880613317
## 35  8.223061450 2.867588089
## 36 74.978035549 8.658985827
## 37 68.414934841 8.271332108
## 38 52.435249859 7.241218810
## 39 43.055168516 6.561643736
## 40 90.213438030 9.498075491
## 41 17.562453542 4.190758111
## 42 51.324415090 7.164106022
## 43 67.236716417 8.199799779
## 44 43.835096573 6.620807849
## 45 26.914226683 5.187892316
## 46  8.501013601 2.915649773
## 47 68.287577224 8.263629785
## 48 21.519906470 4.638955321
## 49 79.190254491 8.898890633
## 50 10.315868864 3.211832633
## 
## $net.result
## $net.result[[1]]
##           [,1]
## 1  4.819945273
## 2  7.987119035
## 3  5.834507254
## 4  9.648285214
## 5  4.805065378
## 6  9.650574839
## 7  4.326960978
## 8  7.269894568
## 9  3.679256436
## 10 6.624339543
## 11 4.652984086
## 12 6.184664575
## 13 7.860100529
## 14 7.687804780
## 15 6.293736760
## 16 1.542502076
## 17 4.075122227
## 18 4.350111087
## 19 7.157153100
## 20 3.143412774
## 21 8.746820944
## 22 8.753438137
## 23 9.678069219
## 24 5.080054600
## 25 7.281198715
## 26 1.269421941
## 27 3.629529292
## 28 2.815014039
## 29 1.842112898
## 30 9.468937146
## 31 6.570010665
## 32 8.666070037
## 33 6.069557794
## 34 7.874959639
## 35 2.863911980
## 36 8.667861260
## 37 8.272482406
## 38 7.234072018
## 39 6.564260237
## 40 9.499585895
## 41 4.189394815
## 42 7.157668053
## 43 8.199502446
## 44 6.622446794
## 45 5.189293065
## 46 2.912409718
## 47 8.264621862
## 48 4.634197778
## 49 8.910764054
## 50 3.214316981
## 
## 
## $weights
## $weights[[1]]
## $weights[[1]][[1]]
##               [,1]          [,2]           [,3]           [,4]
## [1,] 0.67360640097 0.22482860121 -1.55786243865  1.60392718050
## [2,] 0.03731313778 0.03887480531  0.09860394084 -0.02959670477
##                [,5]           [,6]        [,7]         [,8]           [,9]
## [1,] 0.001135159287 -2.22942006514 14.97329767 -2.865672219  1.37192271346
## [2,] 0.057147619171  0.03109411035 13.76829546  1.179575124 -0.03158560342
##             [,10]
## [1,] -1.665898480
## [2,]  0.293959685
## 
## $weights[[1]][[2]]
##                [,1]
##  [1,]  1.1756155553
##  [2,]  0.5749094177
##  [3,]  0.6957707146
##  [4,]  1.6639146400
##  [5,] -1.6417847680
##  [6,]  1.7720526639
##  [7,]  4.3382131122
##  [8,] -0.1269136367
##  [9,]  0.6114945146
## [10,] -1.6853397592
## [11,]  1.1270901534
## 
## 
## 
## $startweights
## $startweights[[1]]
## $startweights[[1]][[1]]
##               [,1]           [,2]          [,3]          [,4]         [,5]
## [1,]  0.6370384668  1.02048025061 -0.2480115920  0.6602196944 0.2661472271
## [2,] -0.4243074993 -0.01144475154  0.2911714933 -1.4028459688 0.1513701405
##               [,6]         [,7]          [,8]           [,9]        [,10]
## [1,] -1.2880135277 2.0048976727 -0.6093301403  0.08104022872 1.1988326618
## [2,]  0.3638310639 0.7998954621  1.2527260283 -0.21545595638 0.5242050015
## 
## $startweights[[1]][[2]]
##                 [,1]
##  [1,]  0.44112039958
##  [2,]  0.46960362458
##  [3,] -0.04669474998
##  [4,]  0.42266624941
##  [5,]  0.01951920610
##  [6,]  1.11486780268
##  [7,]  0.13203359664
##  [8,] -0.86140879242
##  [9,] -0.60586379443
## [10,] -0.22160760572
## [11,]  0.38456300074
## 
## 
## 
## $generalized.weights
## $generalized.weights[[1]]
##                [,1]
## 1  -0.0056831651930
## 2  -0.0011389314053
## 3  -0.0030515857990
## 4  -0.0005761046169
## 5  -0.0057376764154
## 6  -0.0005754361457
## 7  -0.0079297453094
## 8  -0.0014967136177
## 9  -0.0137190896587
## 10 -0.0019925263267
## 11 -0.0063341247986
## 12 -0.0025021129029
## 13 -0.0011934812929
## 14 -0.0012725071423
## 15 -0.0023588448059
## 16 -0.4055506364401
## 17 -0.0096204374103
## 18 -0.0077980495879
## 19 -0.0015676369414
## 20 -0.0241335893214
## 21 -0.0008567806075
## 22 -0.0008545593203
## 23 -0.0005674230133
## 24 -0.0048222616494
## 25 -0.0014898870843
## 26 -0.8529552213992
## 27 -0.0144104956591
## 28 -0.0347222278911
## 29 -0.1962135820513
## 30 -0.0006290491540
## 31 -0.0020463669166
## 32 -0.0008841406965
## 33 -0.0026669934172
## 34 -0.0011869495479
## 35 -0.0328731547629
## 36 -0.0008835285679
## 37 -0.0010254622386
## 38 -0.0015186793261
## 39 -0.0020522014409
## 40 -0.0006199173669
## 41 -0.0087887685660
## 42 -0.0015673006961
## 43 -0.0010534389731
## 44 -0.0019943637025
## 45 -0.0045057524076
## 46 -0.0311456031704
## 47 -0.0010284447620
## 48 -0.0064132511099
## 49 -0.0008026030431
## 50 -0.0223300645540
## 
## 
## $result.matrix
##                                        1
## error                     0.001114126200
## reached.threshold         0.006803039621
## steps                  2191.000000000000
## Intercept.to.1layhid1     0.673606400966
## Input.to.1layhid1         0.037313137783
## Intercept.to.1layhid2     0.224828601212
## Input.to.1layhid2         0.038874805311
## Intercept.to.1layhid3    -1.557862438649
## Input.to.1layhid3         0.098603940843
## Intercept.to.1layhid4     1.603927180499
## Input.to.1layhid4        -0.029596704767
## Intercept.to.1layhid5     0.001135159287
## Input.to.1layhid5         0.057147619171
## Intercept.to.1layhid6    -2.229420065144
## Input.to.1layhid6         0.031094110355
## Intercept.to.1layhid7    14.973297672681
## Input.to.1layhid7        13.768295462060
## Intercept.to.1layhid8    -2.865672218535
## Input.to.1layhid8         1.179575123606
## Intercept.to.1layhid9     1.371922713459
## Input.to.1layhid9        -0.031585603423
## Intercept.to.1layhid10   -1.665898479916
## Input.to.1layhid10        0.293959684959
## Intercept.to.Output       1.175615555268
## 1layhid.1.to.Output       0.574909417656
## 1layhid.2.to.Output       0.695770714598
## 1layhid.3.to.Output       1.663914640008
## 1layhid.4.to.Output      -1.641784767987
## 1layhid.5.to.Output       1.772052663864
## 1layhid.6.to.Output       4.338213112195
## 1layhid.7.to.Output      -0.126913636733
## 1layhid.8.to.Output       0.611494514645
## 1layhid.9.to.Output      -1.685339759203
## 1layhid.10.to.Output      1.127090153367
## 
## attr(,"class")
## [1] "nn"
```

```r
#Plot the neural network
plot(net.sqrt)
 
#Test the neural network on some training data
testdata <- as.data.frame((1:10)^2) #Generate some squared numbers
net.results <- compute(net.sqrt, testdata) #Run them through the neural network
 
#See what properties net.sqrt has
ls(net.results)
```

```
## [1] "net.result" "neurons"
```

```r
#see the results
print(net.results$net.result)
```

```
##              [,1]
##  [1,] 1.114567633
##  [2,] 2.025332595
##  [3,] 2.998033991
##  [4,] 4.001907789
##  [5,] 4.998471401
##  [6,] 6.008788446
##  [7,] 6.995560382
##  [8,] 7.996077318
##  [9,] 9.012267918
## [10,] 9.957619577
```

```r
#Display a better version of the results
cleanoutput <- cbind(testdata,sqrt(testdata),
                         as.data.frame(net.results$net.result))
colnames(cleanoutput) <- c("Input","Expected Output","Neural Net Output")
print(cleanoutput)
```

```
##    Input Expected Output Neural Net Output
## 1      1               1       1.114567633
## 2      4               2       2.025332595
## 3      9               3       2.998033991
## 4     16               4       4.001907789
## 5     25               5       4.998471401
## 6     36               6       6.008788446
## 7     49               7       6.995560382
## 8     64               8       7.996077318
## 9     81               9       9.012267918
## 10   100              10       9.957619577
```

*Acknowledgement: this example excercise was from* http://gekkoquant.com/2012/05/26/neural-networks-with-r-simple-example/ 

