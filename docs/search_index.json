[
["solutions-linear-models.html", "B Solutions ch. 3 - Linear models and matrix algebra B.1 Example 2 B.2 Example 2", " B Solutions ch. 3 - Linear models and matrix algebra Solutions to exercises of chapter 3. B.1 Example 2 We already know the equation that describes the data very well from high school physics. \\[d = h_0 + v_0 t - 0.5 \\times 9.8 t^2\\] with \\(h_0\\) and \\(v_0\\) the starting height and velocity respectively. The data we simulated above followed this equation and added measurement error to simulate n observations for dropping the ball \\((v_0=0)\\) from from height \\((h_0=56.67)\\) Here is what the data looks like with the solid line representing the true trajectory: g &lt;- 9.8 ##meters per second n &lt;- 25 tt &lt;- seq(0,3.4,len=n) ##time in secs, t is a base function f &lt;- 56.67 - 0.5*g*tt^2 y &lt;- f + rnorm(n,sd=1) plot(tt,y,ylab=&quot;Distance in meters&quot;,xlab=&quot;Time in seconds&quot;) lines(tt,f,col=2) In R we can fit this model by simply using the lm function. tt2 &lt;-tt^2 fit &lt;- lm(y~tt+tt2) summary(fit)$coef ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 57.0548046 0.5299866 107.6532936 1.901783e-31 ## tt -0.5225936 0.7219535 -0.7238604 4.767787e-01 ## tt2 -4.7952086 0.2050965 -23.3802560 4.978589e-17 B.2 Example 2 data(father.son,package=&quot;UsingR&quot;) x=father.son$fheight y=father.son$sheight X &lt;- cbind(1,x) thetahat &lt;- solve( t(X) %*% X ) %*% t(X) %*% y ###or thetahat &lt;- solve( crossprod(X) ) %*% crossprod( X, y ) We can see the results of this by computing the estimated \\(\\hat{\\theta}_0+\\hat{\\theta}_1 x\\) for any value of \\(x\\): newx &lt;- seq(min(x),max(x),len=100) X &lt;- cbind(1,newx) fitted &lt;- X%*%thetahat plot(x,y,xlab=&quot;Father&#39;s height&quot;,ylab=&quot;Son&#39;s height&quot;) lines(newx,fitted,col=2) This \\(\\hat{\\boldsymbol{\\theta}}=(\\mathbf{X}^\\top \\mathbf{X})^{-1} \\mathbf{X}^\\top \\mathbf{Y}\\) is one of the most widely used results in data analysis. "]
]
